"use strict";(self.webpackChunkopl_frontend=self.webpackChunkopl_frontend||[]).push([[209],{209:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});var r=s(5861),n=s(5671),a=s(3144),l=s(136),i=s(5716),c=s(7757),o=s.n(c),d=s(2791),u=s(6168),h=s(6871),p=s(4475),_=s(9600),m=s(4650),x=s(7467),v=s(8116),f=s(717),j=s(4292),y=s(3360),b=s(2591),g=s(184),Z=function(e){(0,l.Z)(s,e);var t=(0,i.Z)(s);function s(){var e;(0,n.Z)(this,s);for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={sales_list:void 0!==e.props.sales_list?e.props.sales_list:[],sales_date:e.props.sales_date,depot:"All",product:"All",order_no:null,active:1,spinner:!1,success:!0,delete_order:null},e.onSearchChange=function(t){var s=e.state.active,r=50*(s-1),n=50*s;""===t||void 0===t||null===t?e.setState({sales_list:e.props.sales_list.slice(r,n)}):e.setState({order_no:t})},e.onSearch=function(t){t.preventDefault();var s=e.state.order_no,r=e.props.sales_list;r=r.filter((function(e){return e.order_no.includes(s)})),e.setState({sales_list:r,product:"All",depot:"All"})},e.handleCalc=function(){for(var t=e.state.sales_list,s=0,r=0,n=0;n<t.length;n++){var a=t[n];s+=a.vol_obs,r+=a.vol_obs*a.selling_price}return[r,s]},e.handleProductChange=function(){var t=(0,r.Z)(o().mark((function t(s){var r,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props.sales_list,"All"!==s&&(r=r.filter((function(e){return e.product.name===s}))),"All"!==e.state.depot&&(n=e.props.depots[parseInt(e.state.depot)].name,r=r.filter((function(e){return e.depot.name===n}))),e.setState({sales_list:r,product:s});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleDepotChange=function(t){var s=e.props.sales_list;if("All"!==t){var r=e.props.depots[parseInt(t)].name;s=s.filter((function(e){return e.depot.name===r}))}var n=e.state.product;console.log(n),"All"!==n&&(s=s.filter((function(e){return e.product.name===n}))),e.setState({sales_list:s,depot:t})},e}return(0,a.Z)(s,[{key:"numberWithCommas",value:function(e){try{return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}catch(t){return e}}},{key:"render",value:function(){for(var e=this,t=[],s=this.state.active,r=50*(s-1),n=50*s,a=function(r){t.push((0,g.jsx)(v.Z.Item,{active:r===s,onClick:function(){return e.setState({active:r})},children:r},r))},l=1;l<=Math.ceil(this.state.sales_list.length/50);l++)a(l);var i=this.props,c=i.depots,o=i.products,d=this.handleCalc();return(0,g.jsx)("div",{children:this.state.spinner?(0,g.jsx)(_.Z,{spinner:this.state.spinner}):(0,g.jsxs)("div",{className:"sale-table",children:[(0,g.jsx)("div",{className:"sale-table__header",children:(0,g.jsxs)(f.Z,{className:"d-flex",style:{alignItems:"flex-end"},onSubmit:this.onSearch,children:[(0,g.jsxs)(f.Z.Group,{className:"mb-4 pie-select__child sale-table__select",controlId:"exampleForm.ControlInput1",style:{marginBottom:0},children:[(0,g.jsx)(f.Z.Label,{children:"Depot"}),(0,g.jsxs)(f.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleDepotChange(t.target.value)},children:["All"===this.state.depot?null:(0,g.jsx)("option",{value:this.state.depot,children:c[parseInt(this.state.depot)].name}),(0,g.jsx)("option",{value:"All",children:"All"}),c.map((function(t,s){return e.state.depot===s?null:(0,g.jsx)("option",{value:s,children:t.name},s)}))]})]}),(0,g.jsxs)(f.Z.Group,{className:"mb-4 pie-select__child sale-table__select",controlId:"exampleForm.ControlInput1",style:{marginBottom:0},children:[(0,g.jsx)(f.Z.Label,{children:"Product"}),(0,g.jsxs)(f.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleProductChange(t.target.value)},children:["All"===this.state.product?null:(0,g.jsx)("option",{value:this.state.product,children:this.state.product}),(0,g.jsx)("option",{value:"All",children:"All"}),o.map((function(t,s){return e.state.product===t.name?null:(0,g.jsx)("option",{value:t.name,children:t.name},s)}))]})]}),(0,g.jsx)(j.Z,{type:"search",placeholder:"Search by order no.",className:"me-2 sales-table__search-input","aria-label":"Search by order no.",size:"sm",onChange:function(t){return e.onSearchChange(t.target.value)}}),(0,g.jsx)(y.Z,{variant:"outline-primary",type:"submit",children:"Search"})]})}),(0,g.jsxs)(b.Z,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{}),(0,g.jsx)("th",{children:"Date"}),(0,g.jsx)("th",{children:"Depot"}),(0,g.jsx)("th",{children:"Product"}),(0,g.jsx)("th",{children:"Customer"}),(0,g.jsx)("th",{children:"Order No"}),(0,g.jsx)("th",{children:"Lpo No"}),(0,g.jsx)("th",{children:"Entry No"}),(0,g.jsx)("th",{children:"S.Price"}),(0,g.jsx)("th",{children:"OBS Vol"}),(0,g.jsx)("th",{children:"Vol@20"}),(0,g.jsx)("th",{children:"Amount"}),(0,g.jsx)("th",{children:"Paid"})]})}),(0,g.jsxs)("tbody",{children:[this.state.sales_list.slice(r,n).map((function(t,s){return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:r+s+1}),(0,g.jsx)("td",{children:t.date}),(0,g.jsx)("td",{children:t.depot.name}),(0,g.jsx)("td",{children:t.product.name}),(0,g.jsx)("td",{children:t.customer.name}),(0,g.jsx)("td",{children:t.order_no}),(0,g.jsx)("td",{children:t.lpo_no}),(0,g.jsx)("td",{children:t.entry_no}),(0,g.jsx)("td",{children:t.selling_price}),(0,g.jsx)("td",{children:e.numberWithCommas(t.vol_obs)}),(0,g.jsx)("td",{children:e.numberWithCommas(t.vol_20)}),(0,g.jsx)("td",{children:e.numberWithCommas(t.vol_obs*t.selling_price)}),(0,g.jsx)("td",{children:t.is_paid?"True":"False"})]},s)})),(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{}),(0,g.jsx)("th",{children:"Totals"}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsx)("th",{}),(0,g.jsxs)("th",{children:["Kshs. ",this.numberWithCommas(d[1])]}),(0,g.jsx)("th",{}),(0,g.jsxs)("th",{children:["Kshs. ",this.numberWithCommas(d[0])]}),(0,g.jsx)("th",{})]})]})]}),(0,g.jsx)("div",{children:(0,g.jsx)(v.Z,{size:"sm",children:t})})]})})}}]),s}(d.Component);Z.getDerivedStateFromProps=function(e,t){return t.success=!0,t};var N={GET_SALES_LIST_ACTION:m.dK},S=(0,u.$j)((function(e){var t={start_date:new Date(2022,1,20),end_date:new Date(2022,1,28)};return{sales_date:e.update_reducer.sales_date?e.update_reducer.sales_date:t,depots:e.list_reducer.depot_list,products:e.list_reducer.product_list}}),N)(Z),D=s(6856),C=s(7161),A=function(e){(0,l.Z)(s,e);var t=(0,i.Z)(s);function s(){var e;(0,n.Z)(this,s);for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={startDate:new Date(e.props.sales_date.start_date),endDate:new Date(e.props.sales_date.end_date),key:"selection",date:!0,cost:!1},e.handleSelect=function(){var t=(0,r.Z)(o().mark((function t(s){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({startDate:s.selection.startDate,endDate:s.selection.endDate}),r={start_date:s.selection.startDate,end_date:s.selection.endDate},t.next=4,e.props.UPDATE_SALES_DATE_ACTION(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,a.Z)(s,[{key:"render",value:function(){var e=this.state.startDate,t=this.state.endDate;return(0,g.jsx)("div",{children:(0,g.jsx)("div",{className:"sales-top",children:(0,g.jsx)(x.Z,{trigger:(0,g.jsx)(y.Z,{className:"input-dates",size:"sm",children:(0,g.jsxs)("div",{className:"input-display",children:[(0,g.jsx)("span",{children:(0,g.jsx)(D.kVv,{color:"#D04D30",size:18})}),e.toDateString()," - ",t.toDateString(),(0,g.jsx)("span",{children:(0,g.jsx)(D.Ix0,{size:18})})]})}),position:"bottom",children:(0,g.jsx)(C.Dw,{onChange:this.handleSelect,showSelectionPreview:!0,moveRangeOnFirstSelection:!1,months:2,ranges:[this.state],direction:"horizontal",preventSnapRefocus:!0,calendarFocus:"backwards",className:"date-range"})})})})}}]),s}(d.Component);A.getDerivedStateFromProps=function(e,t){return t.startDate=new Date(e.sales_date.start_date),t.endDate=new Date(e.sales_date.end_date),t};var k={UPDATE_SALES_DATE_ACTION:m.JX},w=(0,u.$j)((function(e){var t={start_date:new Date(2022,3,20),end_date:new Date(2022,3,30)};return{sales_date:e.update_reducer.sales_date?e.update_reducer.sales_date:t,depots:e.list_reducer.depot_list}}),k)(A),T=function(e){(0,l.Z)(s,e);var t=(0,i.Z)(s);function s(){var e;(0,n.Z)(this,s);for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={spinner:!1,redirect:!1,sales_date:e.props.sales_date},e.componentDidMount=(0,r.Z)(o().mark((function t(){var s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.props.sales_date,e.setState({spinner:!0}),t.next=4,e.props.GET_SALES_LIST_ACTION(s.start_date,s.end_date);case 4:case"end":return t.stop()}}),t)}))),e}return(0,a.Z)(s,[{key:"render",value:function(){return this.state.redirect?(0,g.jsx)(h.Fg,{to:"/login"}):(0,g.jsx)(p.Z,{header_title:"Sales",children:this.state.spinner?(0,g.jsx)(_.Z,{spinner:this.state.spinner}):(0,g.jsxs)("div",{children:[(0,g.jsx)(w,{}),(0,g.jsx)(S,{sales_list:this.props.sales_list})]})})}}]),s}(d.Component);T.getDerivedStateFromProps=function(){var e=(0,r.Z)(o().mark((function e(t,s){var r,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.token,n=t.sales_list,a=t.sales_date,void 0!==r&&null!==r){e.next=4;break}return s.redirect=!0,e.abrupt("return",s);case 4:if(s.sales_date.start_date===a.start_date&&s.sales_date.end_date===a.end_date){e.next=12;break}return s.spinner=!0,s.sales_date=a,e.next=9,t.GET_SALES_LIST_ACTION(a.start_date,a.end_date);case 9:return e.abrupt("return",s);case 12:void 0!==n&&(s.spinner=!1,s.redirect=!1);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}();var E={GET_SALES_LIST_ACTION:m.dK},I=(0,u.$j)((function(e){return{token:e.auth_reducer.token,sales_list:e.list_reducer.sales_list,sales_date:e.update_reducer.sales_date}}),E)(T)},4475:function(e,t,s){s.d(t,{Z:function(){return D}});var r=s(5671),n=s(3144),a=s(136),l=s(5716),i=s(2791),c=s(7022),o=s(3360),d=s(6168),u=s(6856),h=s(3504),p=s(6871),_=s(5861),m=s(7757),x=s.n(m),v=s(717),f=s(4650),j=s(184),y=function(e){(0,a.Z)(s,e);var t=(0,l.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(e=t.call.apply(t,[this].concat(a))).state={currency_type:e.props.currency_type},e.handleCurrencyTypeChange=function(){var t=(0,_.Z)(x().mark((function t(s){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.UPDATE_CURRENCY_TYPE_ACTION(s);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,n.Z)(s,[{key:"render",value:function(){var e=this;return(0,j.jsxs)("div",{className:"header",children:[(0,j.jsx)("h5",{children:this.props.header_title}),(0,j.jsxs)("div",{className:"header__left",children:[(0,j.jsx)(v.Z.Group,{className:"header__currency",controlId:"exampleForm.ControlInput1",children:(0,j.jsxs)(v.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleCurrencyTypeChange(t.target.value)},children:[(0,j.jsx)("option",{children:this.state.currency_type}),["Million","Thousand"].map((function(t,s){return e.state.currency_type===t?null:(0,j.jsx)("option",{value:t,children:t},s)}))]})}),(0,j.jsxs)(o.Z,{variant:"secondary",size:"sm",children:[this.props.first_name[0],this.props.last_name[0]]}),(0,j.jsxs)("p",{className:"header__header-name",children:[this.props.first_name," ",this.props.last_name]})]})]})}}]),s}(i.Component);y.getDerivedStateFromProps=function(){var e=(0,_.Z)(x().mark((function e(t,s){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.currency_type=t.currency_type,e.abrupt("return",s);case 2:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}();var b={UPDATE_CURRENCY_TYPE_ACTION:f.wS},g=(0,d.$j)((function(e){return{currency_type:e.update_reducer.currency_type}}),b)(y),Z=s(7883),N=function(e){(0,a.Z)(s,e);var t=(0,l.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(e=t.call.apply(t,[this].concat(a))).state={redirect:!1},e.handleLogOut=function(){e.props.USER_LOGGED_OUT_ACTION(),e.setState({redirect:!0})},e}return(0,n.Z)(s,[{key:"render",value:function(){return this.state.redirect?(0,j.jsx)(p.Fg,{to:"/login"}):(0,j.jsxs)(c.Z,{fluid:!0,className:"layout_main",children:[(0,j.jsxs)("div",{className:"layout_main__side",children:[(0,j.jsx)(h.rU,{to:"/",className:"layout_main__logo",children:(0,j.jsx)("img",{src:"".concat(Z.J,"/static/opl_logo.png"),alt:"logo",className:"layout_main__logo--img"})}),(0,j.jsxs)("div",{className:"layout_main__links",children:[!0===this.props.token.is_staff?(0,j.jsx)(h.OL,{to:"/",className:"layout_main__button",children:(0,j.jsxs)("h6",{children:[(0,j.jsx)("span",{className:"layout_main__links--span",children:(0,j.jsx)(u.bUq,{size:20,color:"#D04D30"})}),"Dashboard"]})}):null,(0,j.jsx)(h.OL,{to:"/depots",className:"layout_main__button",children:(0,j.jsxs)("h6",{children:[(0,j.jsx)("span",{className:"layout_main__links--span",children:(0,j.jsx)(u.UDA,{})}),"Depots"]})}),!0===this.props.token.is_staff?(0,j.jsx)(h.OL,{to:"/sales",className:"layout_main__button",children:(0,j.jsxs)("h6",{children:[(0,j.jsx)("span",{className:"layout_main__links--span",children:(0,j.jsx)(u.jvR,{})}),"Sales"]})}):null,!0===this.props.token.is_staff?(0,j.jsx)(h.OL,{to:"/customers",className:"layout_main__button",children:(0,j.jsxs)("h6",{children:[(0,j.jsx)("span",{className:"layout_main__links--span",children:(0,j.jsx)(u.J8I,{})}),"Customers"]})}):null,(0,j.jsx)(o.Z,{variant:"transparent",className:"layout_main__button layout_main__logout",onClick:this.handleLogOut,children:(0,j.jsxs)("h6",{children:[(0,j.jsx)("span",{className:"layout_main__links--span",children:(0,j.jsx)(u.lE7,{})}),"Log Out"]})})]})]}),(0,j.jsxs)("div",{className:"layout_main__component",children:[(0,j.jsx)(g,{header_title:this.props.header_title,first_name:this.props.token.data.first_name,last_name:this.props.token.data.last_name}),this.props.children]})]})}}]),s}(i.Component),S={USER_LOGGED_OUT_ACTION:f.$},D=(0,d.$j)((function(e){return{token:e.auth_reducer.token}}),S)(N)},8116:function(e,t,s){s.d(t,{Z:function(){return Z}});var r=s(1413),n=s(5987),a=s(1694),l=s.n(a),i=s(2791),c=s(162),o=s(1784),d=s(184),u=["active","disabled","className","style","activeLabel","children"],h=["children"],p=i.forwardRef((function(e,t){var s=e.active,a=e.disabled,i=e.className,c=e.style,h=e.activeLabel,p=e.children,_=(0,n.Z)(e,u),m=s||a?"span":o.Z;return(0,d.jsx)("li",{ref:t,style:c,className:l()(i,"page-item",{active:s,disabled:a}),children:(0,d.jsxs)(m,(0,r.Z)((0,r.Z)({className:"page-link",disabled:a},_),{},{children:[p,s&&h&&(0,d.jsx)("span",{className:"visually-hidden",children:h})]}))})}));p.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},p.displayName="PageItem";var _=p;function m(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,a=i.forwardRef((function(e,a){var l=e.children,i=(0,n.Z)(e,h);return(0,d.jsxs)(p,(0,r.Z)((0,r.Z)({},i),{},{ref:a,children:[(0,d.jsx)("span",{"aria-hidden":"true",children:l||t}),(0,d.jsx)("span",{className:"visually-hidden",children:s})]}))}));return a.displayName=e,a}var x=m("First","\xab"),v=m("Prev","\u2039","Previous"),f=m("Ellipsis","\u2026","More"),j=m("Next","\u203a"),y=m("Last","\xbb"),b=["bsPrefix","className","size"],g=i.forwardRef((function(e,t){var s=e.bsPrefix,a=e.className,i=e.size,o=(0,n.Z)(e,b),u=(0,c.vE)(s,"pagination");return(0,d.jsx)("ul",(0,r.Z)((0,r.Z)({ref:t},o),{},{className:l()(a,u,i&&"".concat(u,"-").concat(i))}))}));g.displayName="Pagination";var Z=Object.assign(g,{First:x,Prev:v,Ellipsis:f,Item:_,Next:j,Last:y})},2591:function(e,t,s){var r=s(1413),n=s(5987),a=s(1694),l=s.n(a),i=s(2791),c=s(162),o=s(184),d=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=i.forwardRef((function(e,t){var s=e.bsPrefix,a=e.className,i=e.striped,u=e.bordered,h=e.borderless,p=e.hover,_=e.size,m=e.variant,x=e.responsive,v=(0,n.Z)(e,d),f=(0,c.vE)(s,"table"),j=l()(a,f,m&&"".concat(f,"-").concat(m),_&&"".concat(f,"-").concat(_),i&&"".concat(f,"-striped"),u&&"".concat(f,"-bordered"),h&&"".concat(f,"-borderless"),p&&"".concat(f,"-hover")),y=(0,o.jsx)("table",(0,r.Z)((0,r.Z)({},v),{},{className:j,ref:t}));if(x){var b="".concat(f,"-responsive");return"string"===typeof x&&(b="".concat(b,"-").concat(x)),(0,o.jsx)("div",{className:b,children:y})}return y}));t.Z=u}}]);
//# sourceMappingURL=209.0c27fbab.chunk.js.map